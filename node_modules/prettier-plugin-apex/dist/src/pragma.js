"use strict";
// This file is copied straight from Prettier's JS implementation,
// since everything works exactly the same for Apex code.
Object.defineProperty(exports, "__esModule", { value: true });
exports.insertPragma = exports.hasPragma = void 0;
const jest_docblock_1 = require("jest-docblock");
function hasPragma(text) {
    const pragmas = Object.keys((0, jest_docblock_1.parse)((0, jest_docblock_1.extract)(text)));
    return pragmas.indexOf("prettier") !== -1 || pragmas.indexOf("format") !== -1;
}
exports.hasPragma = hasPragma;
function insertPragma(text) {
    const parsedDocblock = (0, jest_docblock_1.parseWithComments)((0, jest_docblock_1.extract)(text));
    const pragmas = { format: "", ...parsedDocblock.pragmas };
    const newDocblock = (0, jest_docblock_1.print)({
        pragmas,
        comments: parsedDocblock.comments.replace(/^(\s+?\r?\n)+/, ""), // remove leading newlines
    }).replace(/(\r\n|\r)/g, "\n"); // normalise newlines (mitigate use of os.EOL by jest-docblock)
    const strippedText = (0, jest_docblock_1.strip)(text);
    const separatingNewlines = strippedText.startsWith("\n") ? "\n" : "\n\n";
    return newDocblock + separatingNewlines + strippedText;
}
exports.insertPragma = insertPragma;
